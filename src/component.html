<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>component</title>
</head>

<body>
    <script>
        /**
         * 根据 String 得到 DOM
         * @param domString
         */
        const createDOMFromString = (domString) => {
            const div = document.createElement('div');
            div.innerHTML = domString;
        };

        /**
         * 组件类
         */
        class Component {

            setState(state) {
                const oldEl = this.el;
                this.state = state;
                this.el = this._renderDOM();
                if (this.onStateChange) {
                    this.onStateChange(oldEl, this.el);
                }
            }

            _renderDOM() {
                this.el = createDOMFromString(this.render());
                if (this.onClick) {
                    this.el.addEventListener('click', this.onClick.bind(this), false);
                }
                return this.el;
            }

            // 把组件插入页面
            // setState时更新页面
            const mount = (component, wrapper) => {
                wrapper.appendChild(component._renderDOM());
                component.onStateChange = (oldEl, newEl) => {
                    wrapper.insertBefore(newEl, oldEl);
                    wrapper.removeChild(oldEl);
                }
            }
        }

        class LikeButton extends Component {
            constructor() {
                this.state = {
                    isLiked: !this.state.isLiked
                };
            }

            onClick() {
                this.setState({
                    isLiked: !this.state.isLiked
                });
            }

            render() {
                return `
                    <button class='like-btn'>
                        <span class='like-text>${this.state.isLiked?'取消':'点赞'}</span>
                        <span>👍</span>
                    </button>
                `;
            }
        }
    </script>
</body>

</html>